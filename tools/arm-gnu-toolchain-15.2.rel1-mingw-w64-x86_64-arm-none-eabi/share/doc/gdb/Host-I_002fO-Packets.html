<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- Copyright Â© 1988-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Free Software" and "Free Software Needs
Free Documentation", with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.

(a) The FSF's Back-Cover Text is: "You are free to copy and modify
this GNU Manual.  Buying copies from GNU Press supports the FSF in
developing GNU and promoting software freedom." -->
<title>Host I/O Packets (Debugging with GDB)</title>

<meta name="description" content="Host I/O Packets (Debugging with GDB)">
<meta name="keywords" content="Host I/O Packets (Debugging with GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Remote-Protocol.html" rel="up" title="Remote Protocol">
<link href="Interrupts.html" rel="next" title="Interrupts">
<link href="Tracepoint-Packets.html" rel="prev" title="Tracepoint Packets">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="en">
<div class="section-level-extent" id="Host-I_002fO-Packets">
<div class="nav-panel">
<p>
Next: <a href="Interrupts.html" accesskey="n" rel="next">Interrupts</a>, Previous: <a href="Tracepoint-Packets.html" accesskey="p" rel="prev">Tracepoint Packets</a>, Up: <a href="Remote-Protocol.html" accesskey="u" rel="up"><small class="sc">GDB</small> Remote Serial Protocol</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Host-I_002fO-Packets-1"><span>E.8 Host I/O Packets<a class="copiable-link" href="#Host-I_002fO-Packets-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-Host-I_002fO_002c-remote-protocol"></a>
<a class="index-entry-id" id="index-file-transfer_002c-remote-protocol"></a>

<p>The <em class="dfn">Host I/O</em> packets allow <small class="sc">GDB</small> to perform I/O
operations on the far side of a remote link.  For example, Host I/O is
used to upload and download files to a remote target with its own
filesystem.  Host I/O uses the same constant values and data structure
layout as the target-initiated File-I/O protocol.  However, the
Host I/O packets are structured differently.  The target-initiated
protocol relies on target memory to store parameters and buffers.
Host I/O requests are initiated by <small class="sc">GDB</small>, and the
target&rsquo;s memory is not involved.  See <a class="xref" href="File_002dI_002fO-Remote-Protocol-Extension.html">File-I/O Remote Protocol Extension</a>, for more details on the target-initiated protocol.
</p>
<p>The Host I/O request packets all encode a single operation along with
its arguments.  They have this format:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">vFile:<var class="var">operation</var>: <var class="var">parameter</var>&hellip;</samp>&rsquo;</dt>
<dd><p><var class="var">operation</var> is the name of the particular request; the target
should compare the entire packet name up to the second colon when checking
for a supported operation.  The format of <var class="var">parameter</var> depends on
the operation.  Numbers are always passed in hexadecimal.  Negative
numbers have an explicit minus sign (i.e. two&rsquo;s complement is not
used).  Strings (e.g. filenames) are encoded as a series of
hexadecimal bytes.  The last argument to a system call may be a
buffer of escaped binary data (see <a class="pxref" href="Overview.html#Binary-Data">Binary Data</a>).
</p>
</dd>
</dl>

<p>The valid responses to Host I/O packets are:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">F <var class="var">result</var> [, <var class="var">errno</var>] [; <var class="var">attachment</var>]</samp>&rsquo;</dt>
<dd><p><var class="var">result</var> is the integer value returned by this operation, usually
non-negative for success and -1 for errors.  If an error has occurred,
<var class="var">errno</var> will be included in the result specifying a
value defined by the File-I/O protocol (see <a class="pxref" href="Errno-Values.html">Errno Values</a>).  For
operations which return data, <var class="var">attachment</var> supplies the data as a
binary buffer.  Binary buffers in response packets are escaped in the
normal way (see <a class="pxref" href="Overview.html#Binary-Data">Binary Data</a>).  See the individual packet
documentation for the interpretation of <var class="var">result</var> and
<var class="var">attachment</var>.
</p>
</dd>
<dt>&lsquo;<samp class="samp"><!-- /@w --></samp>&rsquo;</dt>
<dd><p>An empty response indicates that this operation is not recognized.
</p>
</dd>
</dl>

<p>These are the supported Host I/O operations:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">vFile:open: <var class="var">filename</var>, <var class="var">flags</var>, <var class="var">mode</var></samp>&rsquo;</dt>
<dd><p>Open a file at <var class="var">filename</var> and return a file descriptor for it, or
return -1 if an error occurs.  The <var class="var">filename</var> is a string,
<var class="var">flags</var> is an integer indicating a mask of open flags
(see <a class="pxref" href="Open-Flags.html">Open Flags</a>), and <var class="var">mode</var> is an integer indicating a mask
of mode bits to use if the file is created (see <a class="pxref" href="mode_005ft-Values.html">mode_t Values</a>).
See <a class="xref" href="open.html">open</a>, for details of the open flags and mode values.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:close: <var class="var">fd</var></samp>&rsquo;</dt>
<dd><p>Close the open file corresponding to <var class="var">fd</var> and return 0, or
-1 if an error occurs.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:pread: <var class="var">fd</var>, <var class="var">count</var>, <var class="var">offset</var></samp>&rsquo;</dt>
<dd><p>Read data from the open file corresponding to <var class="var">fd</var>.  Up to
<var class="var">count</var> bytes will be read from the file, starting at <var class="var">offset</var>
relative to the start of the file.  The target may read fewer bytes;
common reasons include packet size limits and an end-of-file
condition.  The number of bytes read is returned.  Zero should only be
returned for a successful read at the end of the file, or if
<var class="var">count</var> was zero.
</p>
<p>The data read should be returned as a binary attachment on success.
If zero bytes were read, the response should include an empty binary
attachment (i.e. a trailing semicolon).  The return value is the
number of target bytes read; the binary attachment may be longer if
some characters were escaped.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:pwrite: <var class="var">fd</var>, <var class="var">offset</var>, <var class="var">data</var></samp>&rsquo;</dt>
<dd><p>Write <var class="var">data</var> (a binary buffer) to the open file corresponding
to <var class="var">fd</var>.  Start the write at <var class="var">offset</var> from the start of the
file.  Unlike many <code class="code">write</code> system calls, there is no
separate <var class="var">count</var> argument; the length of <var class="var">data</var> in the
packet is used.  &lsquo;<samp class="samp">vFile:pwrite</samp>&rsquo; returns the number of bytes written,
which may be shorter than the length of <var class="var">data</var>, or -1 if an
error occurred.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:fstat: <var class="var">fd</var></samp>&rsquo;</dt>
<dd><p>Get information about the open file corresponding to <var class="var">fd</var>.
On success the information is returned as a binary attachment
and the return value is the size of this attachment in bytes.
If an error occurs the return value is -1.  The format of the
returned binary attachment is as described in <a class="ref" href="struct-stat.html">struct stat</a>.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:stat: <var class="var">filename</var></samp>&rsquo;</dt>
<dd><p>Get information about the file <var class="var">filename</var> on the target.
On success the information is returned as a binary attachment
and the return value is the size of this attachment in bytes.
If an error occurs the return value is -1.  The format of the
returned binary attachment is as described in <a class="ref" href="struct-stat.html">struct stat</a>.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:unlink: <var class="var">filename</var></samp>&rsquo;</dt>
<dd><p>Delete the file at <var class="var">filename</var> on the target.  Return 0,
or -1 if an error occurs.  The <var class="var">filename</var> is a string.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:readlink: <var class="var">filename</var></samp>&rsquo;</dt>
<dd><p>Read value of symbolic link <var class="var">filename</var> on the target.  Return
the number of bytes read, or -1 if an error occurs.
</p>
<p>The data read should be returned as a binary attachment on success.
If zero bytes were read, the response should include an empty binary
attachment (i.e. a trailing semicolon).  The return value is the
number of target bytes read; the binary attachment may be longer if
some characters were escaped.
</p>
</dd>
<dt>&lsquo;<samp class="samp">vFile:setfs: <var class="var">pid</var></samp>&rsquo;</dt>
<dd><p>Select the filesystem on which <code class="code">vFile</code> operations with
<var class="var">filename</var> arguments will operate.  This is required for
<small class="sc">GDB</small> to be able to access files on remote targets where
the remote stub does not share a common filesystem with the
inferior(s).
</p>
<p>If <var class="var">pid</var> is nonzero, select the filesystem as seen by process
<var class="var">pid</var>.  If <var class="var">pid</var> is zero, select the filesystem as seen by
the remote stub.  Return 0 on success, or -1 if an error occurs.
If <code class="code">vFile:setfs:</code> indicates success, the selected filesystem
remains selected until the next successful <code class="code">vFile:setfs:</code>
operation.
</p>
</dd>
</dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Interrupts.html">Interrupts</a>, Previous: <a href="Tracepoint-Packets.html">Tracepoint Packets</a>, Up: <a href="Remote-Protocol.html"><small class="sc">GDB</small> Remote Serial Protocol</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
