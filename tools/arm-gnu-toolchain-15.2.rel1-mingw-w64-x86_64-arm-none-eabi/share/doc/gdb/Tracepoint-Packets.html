<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- Copyright Â© 1988-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Free Software" and "Free Software Needs
Free Documentation", with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.

(a) The FSF's Back-Cover Text is: "You are free to copy and modify
this GNU Manual.  Buying copies from GNU Press supports the FSF in
developing GNU and promoting software freedom." -->
<title>Tracepoint Packets (Debugging with GDB)</title>

<meta name="description" content="Tracepoint Packets (Debugging with GDB)">
<meta name="keywords" content="Tracepoint Packets (Debugging with GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Remote-Protocol.html" rel="up" title="Remote Protocol">
<link href="Host-I_002fO-Packets.html" rel="next" title="Host I/O Packets">
<link href="Architecture_002dSpecific-Protocol-Details.html" rel="prev" title="Architecture-Specific Protocol Details">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span.r {font-family: initial; font-weight: normal; font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="en">
<div class="section-level-extent" id="Tracepoint-Packets">
<div class="nav-panel">
<p>
Next: <a href="Host-I_002fO-Packets.html" accesskey="n" rel="next">Host I/O Packets</a>, Previous: <a href="Architecture_002dSpecific-Protocol-Details.html" accesskey="p" rel="prev">Architecture-Specific Protocol Details</a>, Up: <a href="Remote-Protocol.html" accesskey="u" rel="up"><small class="sc">GDB</small> Remote Serial Protocol</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Tracepoint-Packets-1"><span>E.7 Tracepoint Packets<a class="copiable-link" href="#Tracepoint-Packets-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-tracepoint-packets"></a>
<a class="index-entry-id" id="index-packets_002c-tracepoint"></a>

<p>Here we describe the packets <small class="sc">GDB</small> uses to implement
tracepoints (see <a class="pxref" href="Tracepoints.html">Tracepoints</a>).
</p>
<dl class="table">
<dt><a id="index-QTDP-packet"></a><span>&lsquo;<samp class="samp">QTDP:<var class="var">n</var>:<var class="var">addr</var>:<var class="var">ena</var>:<var class="var">step</var>:<var class="var">pass</var>[:F<var class="var">flen</var>][:X<var class="var">len</var>,<var class="var">bytes</var>]<span class="r">[</span>-<span class="r">]</span></samp>&rsquo;<a class="copiable-link" href="#index-QTDP-packet"> &para;</a></span></dt>
<dd><p>Create a new tracepoint, number <var class="var">n</var>, at <var class="var">addr</var>.  If <var class="var">ena</var>
is &lsquo;<samp class="samp">E</samp>&rsquo;, then the tracepoint is enabled; if it is &lsquo;<samp class="samp">D</samp>&rsquo;, then
the tracepoint is disabled.  The <var class="var">step</var> gives the tracepoint&rsquo;s step
count, and <var class="var">pass</var> gives its pass count.  If an &lsquo;<samp class="samp">F</samp>&rsquo; is present,
then the tracepoint is to be a fast tracepoint, and the <var class="var">flen</var> is
the number of bytes that the target should copy elsewhere to make room
for the tracepoint.  If an &lsquo;<samp class="samp">X</samp>&rsquo; is present, it introduces a
tracepoint condition, which consists of a hexadecimal length, followed
by a comma and hex-encoded bytes, in a manner similar to action
encodings as described below.  If the trailing &lsquo;<samp class="samp">-</samp>&rsquo; is present,
further &lsquo;<samp class="samp">QTDP</samp>&rsquo; packets will follow to specify this tracepoint&rsquo;s
actions.
</p>
<p>Replies:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">OK</samp>&rsquo;</dt>
<dd><p>The packet was understood and carried out.
</p></dd>
<dt>&lsquo;<samp class="samp">qRelocInsn</samp>&rsquo;</dt>
<dd><p>See <a class="xref" href="#Tracepoint-Packets">Relocate instruction reply packet</a>.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp class="samp">QTDP:-<var class="var">n</var>:<var class="var">addr</var>:<span class="r">[</span>S<span class="r">]</span><var class="var">action</var>&hellip;<span class="r">[</span>-<span class="r">]</span></samp>&rsquo;</dt>
<dd><p>Define actions to be taken when a tracepoint is hit.  The <var class="var">n</var> and
<var class="var">addr</var> must be the same as in the initial &lsquo;<samp class="samp">QTDP</samp>&rsquo; packet for
this tracepoint.  This packet may only be sent immediately after
another &lsquo;<samp class="samp">QTDP</samp>&rsquo; packet that ended with a &lsquo;<samp class="samp">-</samp>&rsquo;.  If the
trailing &lsquo;<samp class="samp">-</samp>&rsquo; is present, further &lsquo;<samp class="samp">QTDP</samp>&rsquo; packets will follow,
specifying more actions for this tracepoint.
</p>
<p>In the series of action packets for a given tracepoint, at most one
can have an &lsquo;<samp class="samp">S</samp>&rsquo; before its first <var class="var">action</var>.  If such a packet
is sent, it and the following packets define &ldquo;while-stepping&rdquo;
actions.  Any prior packets define ordinary actions &mdash; that is, those
taken when the tracepoint is first hit.  If no action packet has an
&lsquo;<samp class="samp">S</samp>&rsquo;, then all the packets in the series specify ordinary
tracepoint actions.
</p>
<p>The &lsquo;<samp class="samp"><var class="var">action</var>&hellip;</samp>&rsquo; portion of the packet is a series of
actions, concatenated without separators.  Each action has one of the
following forms:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">R <var class="var">mask</var></samp>&rsquo;</dt>
<dd><p>Collect the registers whose bits are set in <var class="var">mask</var>,
a hexadecimal number whose <var class="var">i</var>&rsquo;th bit is set if register number
<var class="var">i</var> should be collected.  (The least significant bit is numbered
zero.)  Note that <var class="var">mask</var> may be any number of digits long; it may
not fit in a 32-bit word.
</p>
</dd>
<dt>&lsquo;<samp class="samp">M <var class="var">basereg</var>,<var class="var">offset</var>,<var class="var">len</var></samp>&rsquo;</dt>
<dd><p>Collect <var class="var">len</var> bytes of memory starting at the address in register
number <var class="var">basereg</var>, plus <var class="var">offset</var>.  If <var class="var">basereg</var> is
&lsquo;<samp class="samp">-1</samp>&rsquo;, then the range has a fixed address: <var class="var">offset</var> is the
address of the lowest byte to collect.  The <var class="var">basereg</var>,
<var class="var">offset</var>, and <var class="var">len</var> parameters are all unsigned hexadecimal
values (the &lsquo;<samp class="samp">-1</samp>&rsquo; value for <var class="var">basereg</var> is a special case).
</p>
</dd>
<dt>&lsquo;<samp class="samp">X <var class="var">len</var>,<var class="var">expr</var></samp>&rsquo;</dt>
<dd><p>Evaluate <var class="var">expr</var>, whose length is <var class="var">len</var>, and collect memory as
it directs.  The agent expression <var class="var">expr</var> is as described in
<a class="ref" href="Agent-Expressions.html">The GDB Agent Expression Mechanism</a>.  Each byte of the expression is encoded as a
two-digit hex number in the packet; <var class="var">len</var> is the number of bytes
in the expression (and thus one-half the number of hex digits in the
packet).
</p>
</dd>
</dl>

<p>Any number of actions may be packed together in a single &lsquo;<samp class="samp">QTDP</samp>&rsquo;
packet, as long as the packet does not exceed the maximum packet
length (400 bytes, for many stubs).  There may be only one &lsquo;<samp class="samp">R</samp>&rsquo;
action per tracepoint, and it must precede any &lsquo;<samp class="samp">M</samp>&rsquo; or &lsquo;<samp class="samp">X</samp>&rsquo;
actions.  Any registers referred to by &lsquo;<samp class="samp">M</samp>&rsquo; and &lsquo;<samp class="samp">X</samp>&rsquo; actions
must be collected by a preceding &lsquo;<samp class="samp">R</samp>&rsquo; action.  (The
&ldquo;while-stepping&rdquo; actions are treated as if they were attached to a
separate tracepoint, as far as these restrictions are concerned.)
</p>
<p>Replies:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">OK</samp>&rsquo;</dt>
<dd><p>The packet was understood and carried out.
</p></dd>
<dt>&lsquo;<samp class="samp">qRelocInsn</samp>&rsquo;</dt>
<dd><p>See <a class="xref" href="#Tracepoint-Packets">Relocate instruction reply packet</a>.
</p></dd>
</dl>

</dd>
<dt><a id="index-QTDPsrc-packet"></a><span>&lsquo;<samp class="samp">QTDPsrc:<var class="var">n</var>:<var class="var">addr</var>:<var class="var">type</var>:<var class="var">start</var>:<var class="var">slen</var>:<var class="var">bytes</var></samp>&rsquo;<a class="copiable-link" href="#index-QTDPsrc-packet"> &para;</a></span></dt>
<dd><p>Specify a source string of tracepoint <var class="var">n</var> at address <var class="var">addr</var>.
This is useful to get accurate reproduction of the tracepoints
originally downloaded at the beginning of the trace run.  The <var class="var">type</var>
is the name of the tracepoint part, such as &lsquo;<samp class="samp">cond</samp>&rsquo; for the
tracepoint&rsquo;s conditional expression (see below for a list of types), while
<var class="var">bytes</var> is the string, encoded in hexadecimal.
</p>
<p><var class="var">start</var> is the offset of the <var class="var">bytes</var> within the overall source
string, while <var class="var">slen</var> is the total length of the source string.
This is intended for handling source strings that are longer than will
fit in a single packet.
</p>
<p>The available string types are &lsquo;<samp class="samp">at</samp>&rsquo; for the location,
&lsquo;<samp class="samp">cond</samp>&rsquo; for the conditional, and &lsquo;<samp class="samp">cmd</samp>&rsquo; for an action command.
<small class="sc">GDB</small> sends a separate packet for each command in the action
list, in the same order in which the commands are stored in the list.
</p>
<p>The target does not need to do anything with source strings except
report them back as part of the replies to the &lsquo;<samp class="samp">qTfP</samp>&rsquo;/&lsquo;<samp class="samp">qTsP</samp>&rsquo;
query packets.
</p>
<p>Although this packet is optional, and <small class="sc">GDB</small> will only send it
if the target replies with &lsquo;<samp class="samp">TracepointSource</samp>&rsquo; See <a class="xref" href="General-Query-Packets.html">General Query Packets</a>, it makes both disconnected tracing and trace files
much easier to use.  Otherwise the user must be careful that the
tracepoints in effect while looking at trace frames are identical to
the ones in effect during the trace run; even a small discrepancy
could cause &lsquo;<samp class="samp">tdump</samp>&rsquo; not to work, or a particular trace frame not
be found.
</p>
</dd>
<dt><a class="index-entry-id" id="index-QTDV-packet"></a>
<a id="index-define-trace-state-variable_002c-remote-request"></a><span>&lsquo;<samp class="samp">QTDV:<var class="var">n</var>:<var class="var">value</var>:<var class="var">builtin</var>:<var class="var">name</var></samp>&rsquo;<a class="copiable-link" href="#index-define-trace-state-variable_002c-remote-request"> &para;</a></span></dt>
<dd><p>Create a new trace state variable, number <var class="var">n</var>, with an initial
value of <var class="var">value</var>, which is a 64-bit signed integer.  Both <var class="var">n</var>
and <var class="var">value</var> are encoded as hexadecimal values. <small class="sc">GDB</small> has
the option of not using this packet for initial values of zero; the
target should simply create the trace state variables as they are
mentioned in expressions.  The value <var class="var">builtin</var> should be 1 (one)
if the trace state variable is builtin and 0 (zero) if it is not builtin.
<small class="sc">GDB</small> only sets <var class="var">builtin</var> to 1 if a previous &lsquo;<samp class="samp">qTfV</samp>&rsquo; or
&lsquo;<samp class="samp">qTsV</samp>&rsquo; packet had it set.  The contents of <var class="var">name</var> is the
hex-encoded name (without the leading &lsquo;<samp class="samp">$</samp>&rsquo;) of the trace state
variable.
</p>
</dd>
<dt><a id="index-QTFrame-packet"></a><span>&lsquo;<samp class="samp">QTFrame:<var class="var">n</var></samp>&rsquo;<a class="copiable-link" href="#index-QTFrame-packet"> &para;</a></span></dt>
<dd><p>Select the <var class="var">n</var>&rsquo;th tracepoint frame from the buffer, and use the
register and memory contents recorded there to answer subsequent
request packets from <small class="sc">GDB</small>.
</p>
<p>A successful reply from the stub indicates that the stub has found the
requested frame.  The response is a series of parts, concatenated
without separators, describing the frame we selected.  Each part has
one of the following forms:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">F <var class="var">f</var></samp>&rsquo;</dt>
<dd><p>The selected frame is number <var class="var">n</var> in the trace frame buffer;
<var class="var">f</var> is a hexadecimal number.  If <var class="var">f</var> is &lsquo;<samp class="samp">-1</samp>&rsquo;, then there
was no frame matching the criteria in the request packet.
</p>
</dd>
<dt>&lsquo;<samp class="samp">T <var class="var">t</var></samp>&rsquo;</dt>
<dd><p>The selected trace frame records a hit of tracepoint number <var class="var">t</var>;
<var class="var">t</var> is a hexadecimal number.
</p>
</dd>
</dl>

</dd>
<dt>&lsquo;<samp class="samp">QTFrame:pc:<var class="var">addr</var></samp>&rsquo;</dt>
<dd><p>Like &lsquo;<samp class="samp">QTFrame:<var class="var">n</var></samp>&rsquo;, but select the first tracepoint frame after the
currently selected frame whose PC is <var class="var">addr</var>;
<var class="var">addr</var> is a hexadecimal number.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTFrame:tdp:<var class="var">t</var></samp>&rsquo;</dt>
<dd><p>Like &lsquo;<samp class="samp">QTFrame:<var class="var">n</var></samp>&rsquo;, but select the first tracepoint frame after the
currently selected frame that is a hit of tracepoint <var class="var">t</var>; <var class="var">t</var>
is a hexadecimal number.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTFrame:range:<var class="var">start</var>:<var class="var">end</var></samp>&rsquo;</dt>
<dd><p>Like &lsquo;<samp class="samp">QTFrame:<var class="var">n</var></samp>&rsquo;, but select the first tracepoint frame after the
currently selected frame whose PC is between <var class="var">start</var> (inclusive)
and <var class="var">end</var> (inclusive); <var class="var">start</var> and <var class="var">end</var> are hexadecimal
numbers.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTFrame:outside:<var class="var">start</var>:<var class="var">end</var></samp>&rsquo;</dt>
<dd><p>Like &lsquo;<samp class="samp">QTFrame:range:<var class="var">start</var>:<var class="var">end</var></samp>&rsquo;, but select the first
frame <em class="emph">outside</em> the given range of addresses (exclusive).
</p>
</dd>
<dt><a id="index-qTMinFTPILen-packet"></a><span>&lsquo;<samp class="samp">qTMinFTPILen</samp>&rsquo;<a class="copiable-link" href="#index-qTMinFTPILen-packet"> &para;</a></span></dt>
<dd><p>This packet requests the minimum length of instruction at which a fast
tracepoint (see <a class="pxref" href="Set-Tracepoints.html">Commands to Set Tracepoints</a>) may be placed.  For instance, on
the 32-bit x86 architecture, it is possible to use a 4-byte jump, but
it depends on the target system being able to create trampolines in
the first 64K of memory, which might or might not be possible for that
system.  So the reply to this packet will be 4 if it is able to
arrange for that.
</p>
<p>Replies:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">0</samp>&rsquo;</dt>
<dd><p>The minimum instruction length is currently unknown.
</p></dd>
<dt>&lsquo;<samp class="samp"><var class="var">length</var></samp>&rsquo;</dt>
<dd><p>The minimum instruction length is <var class="var">length</var>, where <var class="var">length</var>
is a hexadecimal number greater or equal to 1.  A reply
of 1 means that a fast tracepoint may be placed on any instruction
regardless of size.
</p></dd>
<dt>&lsquo;<samp class="samp">E</samp>&rsquo;</dt>
<dd><p>An error has occurred.
</p></dd>
</dl>

</dd>
<dt><a id="index-QTStart-packet"></a><span>&lsquo;<samp class="samp">QTStart</samp>&rsquo;<a class="copiable-link" href="#index-QTStart-packet"> &para;</a></span></dt>
<dd><p>Begin the tracepoint experiment.  Begin collecting data from
tracepoint hits in the trace frame buffer.  This packet supports the
&lsquo;<samp class="samp">qRelocInsn</samp>&rsquo; reply (see <a class="pxref" href="#Tracepoint-Packets">Relocate
instruction reply packet</a>).
</p>
</dd>
<dt><a id="index-QTStop-packet"></a><span>&lsquo;<samp class="samp">QTStop</samp>&rsquo;<a class="copiable-link" href="#index-QTStop-packet"> &para;</a></span></dt>
<dd><p>End the tracepoint experiment.  Stop collecting trace frames.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTEnable:<var class="var">n</var>:<var class="var">addr</var></samp>&rsquo;</dt>
<dd><a class="anchor" id="QTEnable"></a><a class="index-entry-id" id="index-QTEnable-packet"></a>
<p>Enable tracepoint <var class="var">n</var> at address <var class="var">addr</var> in a started tracepoint
experiment.  If the tracepoint was previously disabled, then collection
of data from it will resume.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTDisable:<var class="var">n</var>:<var class="var">addr</var></samp>&rsquo;</dt>
<dd><a class="anchor" id="QTDisable"></a><a class="index-entry-id" id="index-QTDisable-packet"></a>
<p>Disable tracepoint <var class="var">n</var> at address <var class="var">addr</var> in a started tracepoint
experiment.  No more data will be collected from the tracepoint unless
&lsquo;<samp class="samp">QTEnable:<var class="var">n</var>:<var class="var">addr</var></samp>&rsquo; is subsequently issued.
</p>
</dd>
<dt><a id="index-QTinit-packet"></a><span>&lsquo;<samp class="samp">QTinit</samp>&rsquo;<a class="copiable-link" href="#index-QTinit-packet"> &para;</a></span></dt>
<dd><p>Clear the table of tracepoints, and empty the trace frame buffer.
</p>
</dd>
<dt><a id="index-QTro-packet"></a><span>&lsquo;<samp class="samp">QTro:<var class="var">start1</var>,<var class="var">end1</var>:<var class="var">start2</var>,<var class="var">end2</var>:&hellip;</samp>&rsquo;<a class="copiable-link" href="#index-QTro-packet"> &para;</a></span></dt>
<dd><p>Establish the given ranges of memory as &ldquo;transparent&rdquo;.  The stub
will answer requests for these ranges from memory&rsquo;s current contents,
if they were not collected as part of the tracepoint hit.
</p>
<p><small class="sc">GDB</small> uses this to mark read-only regions of memory, like those
containing program code.  Since these areas never change, they should
still have the same contents they did when the tracepoint was hit, so
there&rsquo;s no reason for the stub to refuse to provide their contents.
</p>
</dd>
<dt><a id="index-QTDisconnected-packet"></a><span>&lsquo;<samp class="samp">QTDisconnected:<var class="var">value</var></samp>&rsquo;<a class="copiable-link" href="#index-QTDisconnected-packet"> &para;</a></span></dt>
<dd><p>Set the choice to what to do with the tracing run when <small class="sc">GDB</small>
disconnects from the target.  A <var class="var">value</var> of 1 directs the target to
continue the tracing run, while 0 tells the target to stop tracing if
<small class="sc">GDB</small> is no longer in the picture.
</p>
</dd>
<dt><a id="index-qTStatus-packet"></a><span>&lsquo;<samp class="samp">qTStatus</samp>&rsquo;<a class="copiable-link" href="#index-qTStatus-packet"> &para;</a></span></dt>
<dd><p>Ask the stub if there is a trace experiment running right now.
</p>
<p>The reply has the form:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">T<var class="var">running</var><span class="r">[</span>;<var class="var">field</var><span class="r">]</span>&hellip;</samp>&rsquo;</dt>
<dd><p><var class="var">running</var> is a single digit <code class="code">1</code> if the trace is presently
running, or <code class="code">0</code> if not.  It is followed by semicolon-separated
optional fields that an agent may use to report additional status.
</p>
</dd>
</dl>

<p>If the trace is not running, the agent may report any of several
explanations as one of the optional fields:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">tnotrun:0</samp>&rsquo;</dt>
<dd><p>No trace has been run yet.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tstop[:<var class="var">text</var>]:0</samp>&rsquo;</dt>
<dd><p>The trace was stopped by a user-originated stop command.  The optional
<var class="var">text</var> field is a user-supplied string supplied as part of the
stop command (for instance, an explanation of why the trace was
stopped manually).  It is hex-encoded.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tfull:0</samp>&rsquo;</dt>
<dd><p>The trace stopped because the trace buffer filled up.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tdisconnected:0</samp>&rsquo;</dt>
<dd><p>The trace stopped because <small class="sc">GDB</small> disconnected from the target.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tpasscount:<var class="var">tpnum</var></samp>&rsquo;</dt>
<dd><p>The trace stopped because tracepoint <var class="var">tpnum</var> exceeded its pass count.
</p>
</dd>
<dt>&lsquo;<samp class="samp">terror:<var class="var">text</var>:<var class="var">tpnum</var></samp>&rsquo;</dt>
<dd><p>The trace stopped because tracepoint <var class="var">tpnum</var> had an error.  The
string <var class="var">text</var> is available to describe the nature of the error
(for instance, a divide by zero in the condition expression); it
is hex encoded.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tunknown:0</samp>&rsquo;</dt>
<dd><p>The trace stopped for some other reason.
</p>
</dd>
</dl>

<p>Additional optional fields supply statistical and other information.
Although not required, they are extremely useful for users monitoring
the progress of a trace run.  If a trace has stopped, and these
numbers are reported, they must reflect the state of the just-stopped
trace.
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">tframes:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The number of trace frames in the buffer.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tcreated:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The total number of trace frames created during the run. This may
be larger than the trace frame count, if the buffer is circular.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tsize:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The total size of the trace buffer, in bytes.
</p>
</dd>
<dt>&lsquo;<samp class="samp">tfree:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The number of bytes still unused in the buffer.
</p>
</dd>
<dt>&lsquo;<samp class="samp">circular:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The value of the circular trace buffer flag.  <code class="code">1</code> means that the
trace buffer is circular and old trace frames will be discarded if
necessary to make room, <code class="code">0</code> means that the trace buffer is linear
and may fill up.
</p>
</dd>
<dt>&lsquo;<samp class="samp">disconn:<var class="var">n</var></samp>&rsquo;</dt>
<dd><p>The value of the disconnected tracing flag.  <code class="code">1</code> means that
tracing will continue after <small class="sc">GDB</small> disconnects, <code class="code">0</code> means
that the trace run will stop.
</p>
</dd>
</dl>

</dd>
<dt><a class="index-entry-id" id="index-qTP-packet"></a>
<a id="index-tracepoint-status_002c-remote-request"></a><span>&lsquo;<samp class="samp">qTP:<var class="var">tp</var>:<var class="var">addr</var></samp>&rsquo;<a class="copiable-link" href="#index-tracepoint-status_002c-remote-request"> &para;</a></span></dt>
<dd><p>Ask the stub for the current state of tracepoint number <var class="var">tp</var> at
address <var class="var">addr</var>.
</p>
<p>Replies:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">V<var class="var">hits</var>:<var class="var">usage</var></samp>&rsquo;</dt>
<dd><p>The tracepoint has been hit <var class="var">hits</var> times so far during the trace
run, and accounts for <var class="var">usage</var> in the trace buffer.  Note that
<code class="code">while-stepping</code> steps are not counted as separate hits, but the
steps&rsquo; space consumption is added into the usage number.
</p>
</dd>
</dl>

</dd>
<dt><a class="index-entry-id" id="index-qTV-packet"></a>
<a id="index-trace-state-variable-value_002c-remote-request"></a><span>&lsquo;<samp class="samp">qTV:<var class="var">var</var></samp>&rsquo;<a class="copiable-link" href="#index-trace-state-variable-value_002c-remote-request"> &para;</a></span></dt>
<dd><p>Ask the stub for the value of the trace state variable number <var class="var">var</var>.
</p>
<p>Replies:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">V<var class="var">value</var></samp>&rsquo;</dt>
<dd><p>The value of the variable is <var class="var">value</var>.  This will be the current
value of the variable if the user is examining a running target, or a
saved value if the variable was collected in the trace frame that the
user is looking at.  Note that multiple requests may result in
different reply values, such as when requesting values while the
program is running.
</p>
</dd>
<dt>&lsquo;<samp class="samp">U</samp>&rsquo;</dt>
<dd><p>The value of the variable is unknown.  This would occur, for example,
if the user is examining a trace frame in which the requested variable
was not collected.
</p></dd>
</dl>

</dd>
<dt><a id="index-qTsP-packet"></a><span>&lsquo;<samp class="samp">qTfP</samp>&rsquo;<a class="copiable-link" href="#index-qTsP-packet"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-qTfP-packet"></a>
</dd>
<dt>&lsquo;<samp class="samp">qTsP</samp>&rsquo;</dt>
<dd><p>These packets request data about tracepoints that are being used by
the target.  <small class="sc">GDB</small> sends <code class="code">qTfP</code> to get the first piece
of data, and multiple <code class="code">qTsP</code> to get additional pieces.  Replies
to these packets generally take the form of the <code class="code">QTDP</code> packets
that define tracepoints. (FIXME add detailed syntax)
</p>
</dd>
<dt><a id="index-qTsV-packet"></a><span>&lsquo;<samp class="samp">qTfV</samp>&rsquo;<a class="copiable-link" href="#index-qTsV-packet"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-qTfV-packet"></a>
</dd>
<dt>&lsquo;<samp class="samp">qTsV</samp>&rsquo;</dt>
<dd><p>These packets request data about trace state variables that are on the
target.  <small class="sc">GDB</small> sends <code class="code">qTfV</code> to get the first vari of data,
and multiple <code class="code">qTsV</code> to get additional variables.  Replies to
these packets follow the syntax of the <code class="code">QTDV</code> packets that define
trace state variables.
</p>
</dd>
<dt>&lsquo;<samp class="samp">qTfSTM</samp>&rsquo;</dt>
<dt>&lsquo;<samp class="samp">qTsSTM</samp>&rsquo;</dt>
<dd><a class="anchor" id="qTfSTM"></a><a class="anchor" id="qTsSTM"></a><a class="index-entry-id" id="index-qTfSTM-packet"></a>
<a class="index-entry-id" id="index-qTsSTM-packet"></a>
<p>These packets request data about static tracepoint markers that exist
in the target program.  <small class="sc">GDB</small> sends <code class="code">qTfSTM</code> to get the
first piece of data, and multiple <code class="code">qTsSTM</code> to get additional
pieces.  Replies to these packets take the following form:
</p>
<p>Reply:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">m <var class="var">address</var>:<var class="var">id</var>:<var class="var">extra</var></samp>&rsquo;</dt>
<dd><p>A single marker
</p></dd>
<dt>&lsquo;<samp class="samp">m <var class="var">address</var>:<var class="var">id</var>:<var class="var">extra</var>,<var class="var">address</var>:<var class="var">id</var>:<var class="var">extra</var>&hellip;</samp>&rsquo;</dt>
<dd><p>a comma-separated list of markers
</p></dd>
<dt>&lsquo;<samp class="samp">l</samp>&rsquo;</dt>
<dd><p>(lower case letter &lsquo;<samp class="samp">L</samp>&rsquo;) denotes end of list.
</p></dd>
</dl>

<p>The <var class="var">address</var> is encoded in hex;
<var class="var">id</var> and <var class="var">extra</var> are strings encoded in hex.
</p>
<p>In response to each query, the target will reply with a list of one or
more markers, separated by commas.  <small class="sc">GDB</small> will respond to each
reply with a request for more markers (using the &lsquo;<samp class="samp">qs</samp>&rsquo; form of the
query), until the target responds with &lsquo;<samp class="samp">l</samp>&rsquo; (lower-case ell, for
<em class="dfn">last</em>).
</p>
</dd>
<dt>&lsquo;<samp class="samp">qTSTMat:<var class="var">address</var></samp>&rsquo;</dt>
<dd><a class="anchor" id="qTSTMat"></a><a class="index-entry-id" id="index-qTSTMat-packet"></a>
<p>This packets requests data about static tracepoint markers in the
target program at <var class="var">address</var>.  Replies to this packet follow the
syntax of the &lsquo;<samp class="samp">qTfSTM</samp>&rsquo; and <code class="code">qTsSTM</code> packets that list static
tracepoint markers.
</p>
</dd>
<dt><a id="index-QTSave-packet"></a><span>&lsquo;<samp class="samp">QTSave:<var class="var">filename</var></samp>&rsquo;<a class="copiable-link" href="#index-QTSave-packet"> &para;</a></span></dt>
<dd><p>This packet directs the target to save trace data to the file name
<var class="var">filename</var> in the target&rsquo;s filesystem.  The <var class="var">filename</var> is encoded
as a hex string; the interpretation of the file name (relative vs
absolute, wild cards, etc) is up to the target.
</p>
</dd>
<dt><a id="index-qTBuffer-packet"></a><span>&lsquo;<samp class="samp">qTBuffer:<var class="var">offset</var>,<var class="var">len</var></samp>&rsquo;<a class="copiable-link" href="#index-qTBuffer-packet"> &para;</a></span></dt>
<dd><p>Return up to <var class="var">len</var> bytes of the current contents of trace buffer,
starting at <var class="var">offset</var>.  The trace buffer is treated as if it were
a contiguous collection of traceframes, as per the trace file format.
The reply consists as many hex-encoded bytes as the target can deliver
in a packet; it is not an error to return fewer than were asked for.
A reply consisting of just <code class="code">l</code> indicates that no bytes are
available.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTBuffer:circular:<var class="var">value</var></samp>&rsquo;</dt>
<dd><p>This packet directs the target to use a circular trace buffer if
<var class="var">value</var> is 1, or a linear buffer if the value is 0.
</p>
</dd>
<dt>&lsquo;<samp class="samp">QTBuffer:size:<var class="var">size</var></samp>&rsquo;</dt>
<dd><a class="anchor" id="QTBuffer_002dsize"></a><a class="index-entry-id" id="index-QTBuffer-size-packet"></a>
<p>This packet directs the target to make the trace buffer be of size
<var class="var">size</var> if possible.  A value of <code class="code">-1</code> tells the target to
use whatever size it prefers.
</p>
</dd>
<dt><a id="index-QTNotes-packet"></a><span>&lsquo;<samp class="samp">QTNotes:<span class="r">[</span><var class="var">type</var>:<var class="var">text</var><span class="r">]</span><span class="r">[</span>;<var class="var">type</var>:<var class="var">text</var><span class="r">]</span>&hellip;</samp>&rsquo;<a class="copiable-link" href="#index-QTNotes-packet"> &para;</a></span></dt>
<dd><p>This packet adds optional textual notes to the trace run.  Allowable
types include <code class="code">user</code>, <code class="code">notes</code>, and <code class="code">tstop</code>, the
<var class="var">text</var> fields are arbitrary strings, hex-encoded.
</p>
</dd>
</dl>

<ul class="mini-toc">
<li><a href="#Relocate-instruction-reply-packet" accesskey="1">Relocate instruction reply packet</a></li>
</ul>
<div class="subsection-level-extent" id="Relocate-instruction-reply-packet">
<h4 class="subsection"><span>E.7.1 Relocate instruction reply packet<a class="copiable-link" href="#Relocate-instruction-reply-packet"> &para;</a></span></h4>
<p>When installing fast tracepoints in memory, the target may need to
relocate the instruction currently at the tracepoint address to a
different address in memory.  For most instructions, a simple copy is
enough, but, for example, call instructions that implicitly push the
return address on the stack, and relative branches or other
PC-relative instructions require offset adjustment, so that the effect
of executing the instruction at a different address is the same as if
it had executed in the original location.
</p>
<p>In response to several of the tracepoint packets, the target may also
respond with a number of intermediate &lsquo;<samp class="samp">qRelocInsn</samp>&rsquo; request
packets before the final result packet, to have <small class="sc">GDB</small> handle
this relocation operation.  If a packet supports this mechanism, its
documentation will explicitly say so.  See for example the above
descriptions for the &lsquo;<samp class="samp">QTStart</samp>&rsquo; and &lsquo;<samp class="samp">QTDP</samp>&rsquo; packets.  The
format of the request is:
</p>
<dl class="table">
<dt>&lsquo;<samp class="samp">qRelocInsn:<var class="var">from</var>;<var class="var">to</var></samp>&rsquo;</dt>
<dd>
<p>This requests <small class="sc">GDB</small> to copy instruction at address <var class="var">from</var>
to address <var class="var">to</var>, possibly adjusted so that executing the
instruction at <var class="var">to</var> has the same effect as executing it at
<var class="var">from</var>.  <small class="sc">GDB</small> writes the adjusted instruction to target
memory starting at <var class="var">to</var>.
</p></dd>
</dl>

<p>Replies:
</p><dl class="table">
<dt>&lsquo;<samp class="samp">qRelocInsn:<var class="var">adjusted_size</var></samp>&rsquo;</dt>
<dd><p>Informs the stub the relocation is complete.  The <var class="var">adjusted_size</var> is
the length in bytes of resulting relocated instruction sequence.
</p></dd>
</dl>

</div>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Host-I_002fO-Packets.html">Host I/O Packets</a>, Previous: <a href="Architecture_002dSpecific-Protocol-Details.html">Architecture-Specific Protocol Details</a>, Up: <a href="Remote-Protocol.html"><small class="sc">GDB</small> Remote Serial Protocol</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
