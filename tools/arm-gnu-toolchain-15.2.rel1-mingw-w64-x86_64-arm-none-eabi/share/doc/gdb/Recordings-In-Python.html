<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- Copyright Â© 1988-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Free Software" and "Free Software Needs
Free Documentation", with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.

(a) The FSF's Back-Cover Text is: "You are free to copy and modify
this GNU Manual.  Buying copies from GNU Press supports the FSF in
developing GNU and promoting software freedom." -->
<title>Recordings In Python (Debugging with GDB)</title>

<meta name="description" content="Recordings In Python (Debugging with GDB)">
<meta name="keywords" content="Recordings In Python (Debugging with GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Python-API.html" rel="up" title="Python API">
<link href="CLI-Commands-In-Python.html" rel="next" title="CLI Commands In Python">
<link href="Threads-In-Python.html" rel="prev" title="Threads In Python">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span.r {font-family: initial; font-weight: normal; font-style: normal}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
ul.mark-bullet {list-style-type: disc}
-->
</style>


</head>

<body lang="en">
<div class="subsubsection-level-extent" id="Recordings-In-Python">
<div class="nav-panel">
<p>
Next: <a href="CLI-Commands-In-Python.html" accesskey="n" rel="next">CLI Commands In Python</a>, Previous: <a href="Threads-In-Python.html" accesskey="p" rel="prev">Threads In Python</a>, Up: <a href="Python-API.html" accesskey="u" rel="up">Python API</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsubsection" id="Recordings-In-Python-1"><span>23.3.2.20 Recordings In Python<a class="copiable-link" href="#Recordings-In-Python-1"> &para;</a></span></h4>
<a class="index-entry-id" id="index-recordings-in-python"></a>

<p>The following recordings-related functions
(see <a class="pxref" href="Process-Record-and-Replay.html">Recording Inferior&rsquo;s Execution and Replaying It</a>) are available in the <code class="code">gdb</code>
module:
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-gdb_002estart_005frecording"><span class="category-def">Function: </span><span><strong class="def-name">gdb.start_recording</strong> <var class="def-var-arguments">(<span class="r">[</span>method<span class="r">]</span>, <span class="r">[</span>format<span class="r">]</span>)</var><a class="copiable-link" href="#index-gdb_002estart_005frecording"> &para;</a></span></dt>
<dd><p>Start a recording using the given <var class="var">method</var> and <var class="var">format</var>.  If
no <var class="var">format</var> is given, the default format for the recording method
is used.  If no <var class="var">method</var> is given, the default method will be used.
Returns a <code class="code">gdb.Record</code> object on success.  Throw an exception on
failure.
</p>
<p>The following strings can be passed as <var class="var">method</var>:
</p>
<ul class="itemize mark-bullet">
<li><code class="code">&quot;full&quot;</code>
</li><li><code class="code">&quot;btrace&quot;</code>: Possible values for <var class="var">format</var>: <code class="code">&quot;pt&quot;</code>,
<code class="code">&quot;bts&quot;</code> or leave out for default format.
</li></ul>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-gdb_002ecurrent_005frecording"><span class="category-def">Function: </span><span><strong class="def-name">gdb.current_recording</strong> <var class="def-var-arguments">()</var><a class="copiable-link" href="#index-gdb_002ecurrent_005frecording"> &para;</a></span></dt>
<dd><p>Access a currently running recording.  Return a <code class="code">gdb.Record</code>
object on success.  Return <code class="code">None</code> if no recording is currently
active.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-gdb_002estop_005frecording"><span class="category-def">Function: </span><span><strong class="def-name">gdb.stop_recording</strong> <var class="def-var-arguments">()</var><a class="copiable-link" href="#index-gdb_002estop_005frecording"> &para;</a></span></dt>
<dd><p>Stop the current recording.  Throw an exception if no recording is
currently active.  All record objects become invalid after this call.
</p></dd></dl>

<p>A <code class="code">gdb.Record</code> object has the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002emethod"><span class="category-def">Variable: </span><span><strong class="def-name">Record.method</strong><a class="copiable-link" href="#index-Record_002emethod"> &para;</a></span></dt>
<dd><p>A string with the current recording method, e.g. <code class="code">full</code> or
<code class="code">btrace</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002eformat"><span class="category-def">Variable: </span><span><strong class="def-name">Record.format</strong><a class="copiable-link" href="#index-Record_002eformat"> &para;</a></span></dt>
<dd><p>A string with the current recording format, e.g. <code class="code">bt</code>, <code class="code">pts</code> or
<code class="code">None</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002ebegin"><span class="category-def">Variable: </span><span><strong class="def-name">Record.begin</strong><a class="copiable-link" href="#index-Record_002ebegin"> &para;</a></span></dt>
<dd><p>A method specific instruction object representing the first instruction
in this recording.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002eend"><span class="category-def">Variable: </span><span><strong class="def-name">Record.end</strong><a class="copiable-link" href="#index-Record_002eend"> &para;</a></span></dt>
<dd><p>A method specific instruction object representing the current
instruction, that is not actually part of the recording.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002ereplay_005fposition"><span class="category-def">Variable: </span><span><strong class="def-name">Record.replay_position</strong><a class="copiable-link" href="#index-Record_002ereplay_005fposition"> &para;</a></span></dt>
<dd><p>The instruction representing the current replay position.  If there is
no replay active, this will be <code class="code">None</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002einstruction_005fhistory"><span class="category-def">Variable: </span><span><strong class="def-name">Record.instruction_history</strong><a class="copiable-link" href="#index-Record_002einstruction_005fhistory"> &para;</a></span></dt>
<dd><p>A list with all recorded instructions.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Record_002efunction_005fcall_005fhistory"><span class="category-def">Variable: </span><span><strong class="def-name">Record.function_call_history</strong><a class="copiable-link" href="#index-Record_002efunction_005fcall_005fhistory"> &para;</a></span></dt>
<dd><p>A list with all recorded function call segments.
</p></dd></dl>

<p>A <code class="code">gdb.Record</code> object has the following methods:
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-Record_002egoto"><span class="category-def">Function: </span><span><strong class="def-name">Record.goto</strong> <var class="def-var-arguments">(instruction)</var><a class="copiable-link" href="#index-Record_002egoto"> &para;</a></span></dt>
<dd><p>Move the replay position to the given <var class="var">instruction</var>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-Record_002eclear"><span class="category-def">Function: </span><span><strong class="def-name">Record.clear</strong> <var class="def-var-arguments">()</var><a class="copiable-link" href="#index-Record_002eclear"> &para;</a></span></dt>
<dd><p>Clear the trace data of the current recording.  This forces re-decoding of the
trace for successive commands.
</p></dd></dl>

<p>The common <code class="code">gdb.Instruction</code> class that recording method specific
instruction objects inherit from, has the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Instruction_002epc"><span class="category-def">Variable: </span><span><strong class="def-name">Instruction.pc</strong><a class="copiable-link" href="#index-Instruction_002epc"> &para;</a></span></dt>
<dd><p>An integer representing this instruction&rsquo;s address.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Instruction_002edata"><span class="category-def">Variable: </span><span><strong class="def-name">Instruction.data</strong><a class="copiable-link" href="#index-Instruction_002edata"> &para;</a></span></dt>
<dd><p>A <code class="code">memoryview</code> object holding the raw instruction data.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Instruction_002edecoded"><span class="category-def">Variable: </span><span><strong class="def-name">Instruction.decoded</strong><a class="copiable-link" href="#index-Instruction_002edecoded"> &para;</a></span></dt>
<dd><p>A human readable string with the disassembled instruction.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-Instruction_002esize"><span class="category-def">Variable: </span><span><strong class="def-name">Instruction.size</strong><a class="copiable-link" href="#index-Instruction_002esize"> &para;</a></span></dt>
<dd><p>The size of the instruction in bytes.
</p></dd></dl>

<p>Additionally <code class="code">gdb.RecordInstruction</code> has the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordInstruction_002enumber"><span class="category-def">Variable: </span><span><strong class="def-name">RecordInstruction.number</strong><a class="copiable-link" href="#index-RecordInstruction_002enumber"> &para;</a></span></dt>
<dd><p>An integer identifying this instruction.  <code class="code">number</code> corresponds to
the numbers seen in <code class="code">record instruction-history</code>
(see <a class="pxref" href="Process-Record-and-Replay.html">Recording Inferior&rsquo;s Execution and Replaying It</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordInstruction_002esal"><span class="category-def">Variable: </span><span><strong class="def-name">RecordInstruction.sal</strong><a class="copiable-link" href="#index-RecordInstruction_002esal"> &para;</a></span></dt>
<dd><p>A <code class="code">gdb.Symtab_and_line</code> object representing the associated symtab
and line of this instruction.  May be <code class="code">None</code> if no debug information is
available.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordInstruction_002eis_005fspeculative"><span class="category-def">Variable: </span><span><strong class="def-name">RecordInstruction.is_speculative</strong><a class="copiable-link" href="#index-RecordInstruction_002eis_005fspeculative"> &para;</a></span></dt>
<dd><p>A boolean indicating whether the instruction was executed speculatively.
</p></dd></dl>

<p>If an error occurred during recording or decoding a recording, this error is
represented by a <code class="code">gdb.RecordGap</code> object in the instruction list.  It has
the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordGap_002enumber"><span class="category-def">Variable: </span><span><strong class="def-name">RecordGap.number</strong><a class="copiable-link" href="#index-RecordGap_002enumber"> &para;</a></span></dt>
<dd><p>An integer identifying this gap.  <code class="code">number</code> corresponds to the numbers seen
in <code class="code">record instruction-history</code> (see <a class="pxref" href="Process-Record-and-Replay.html">Recording Inferior&rsquo;s Execution and Replaying It</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordGap_002eerror_005fcode"><span class="category-def">Variable: </span><span><strong class="def-name">RecordGap.error_code</strong><a class="copiable-link" href="#index-RecordGap_002eerror_005fcode"> &para;</a></span></dt>
<dd><p>A numerical representation of the reason for the gap.  The value is specific to
the current recording method.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordGap_002eerror_005fstring"><span class="category-def">Variable: </span><span><strong class="def-name">RecordGap.error_string</strong><a class="copiable-link" href="#index-RecordGap_002eerror_005fstring"> &para;</a></span></dt>
<dd><p>A human readable string with the reason for the gap.
</p></dd></dl>

<p>Some <small class="sc">GDB</small> features write auxiliary information into the execution
history.  This information is represented by a <code class="code">gdb.RecordAuxiliary</code> object
in the instruction list.  It has the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordAuxiliary_002enumber"><span class="category-def">Variable: </span><span><strong class="def-name">RecordAuxiliary.<var class="var">number</var></strong><a class="copiable-link" href="#index-RecordAuxiliary_002enumber"> &para;</a></span></dt>
<dd><p>An integer identifying this auxiliary.  <var class="var">number</var> corresponds to the numbers
seen in <code class="code">record instruction-history</code> (see <a class="pxref" href="Process-Record-and-Replay.html">Recording Inferior&rsquo;s Execution and Replaying It</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordAuxiliary_002edata"><span class="category-def">Variable: </span><span><strong class="def-name">RecordAuxiliary.data</strong><a class="copiable-link" href="#index-RecordAuxiliary_002edata"> &para;</a></span></dt>
<dd><p>A string representation of the auxiliary data.
</p></dd></dl>

<p>A <code class="code">gdb.RecordFunctionSegment</code> object has the following attributes:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002enumber"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.number</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002enumber"> &para;</a></span></dt>
<dd><p>An integer identifying this function segment.  <code class="code">number</code> corresponds to
the numbers seen in <code class="code">record function-call-history</code>
(see <a class="pxref" href="Process-Record-and-Replay.html">Recording Inferior&rsquo;s Execution and Replaying It</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002esymbol"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.symbol</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002esymbol"> &para;</a></span></dt>
<dd><p>A <code class="code">gdb.Symbol</code> object representing the associated symbol.  May be
<code class="code">None</code> if no debug information is available.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002elevel"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.level</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002elevel"> &para;</a></span></dt>
<dd><p>An integer representing the function call&rsquo;s stack level.  May be
<code class="code">None</code> if the function call is a gap.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002einstructions"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.instructions</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002einstructions"> &para;</a></span></dt>
<dd><p>A list of <code class="code">gdb.RecordInstruction</code> or <code class="code">gdb.RecordGap</code> objects
associated with this function call.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002eup"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.up</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002eup"> &para;</a></span></dt>
<dd><p>A <code class="code">gdb.RecordFunctionSegment</code> object representing the caller&rsquo;s
function segment.  If the call has not been recorded, this will be the
function segment to which control returns.  If neither the call nor the
return have been recorded, this will be <code class="code">None</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002eprev"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.prev</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002eprev"> &para;</a></span></dt>
<dd><p>A <code class="code">gdb.RecordFunctionSegment</code> object representing the previous
segment of this function call.  May be <code class="code">None</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-RecordFunctionSegment_002enext"><span class="category-def">Variable: </span><span><strong class="def-name">RecordFunctionSegment.next</strong><a class="copiable-link" href="#index-RecordFunctionSegment_002enext"> &para;</a></span></dt>
<dd><p>A <code class="code">gdb.RecordFunctionSegment</code> object representing the next segment of
this function call.  May be <code class="code">None</code>.
</p></dd></dl>

<p>The following example demonstrates the usage of these objects and
functions to create a function that will rewind a record to the last
time a function in a different file was executed.  This would typically
be used to track the execution of user provided callback functions in a
library which typically are not visible in a back trace.
</p>
<div class="example smallexample">
<pre class="example-preformatted">def bringback ():
    rec = gdb.current_recording ()
    if not rec:
        return

    insn = rec.instruction_history
    if len (insn) == 0:
        return

    try:
        position = insn.index (rec.replay_position)
    except:
        position = -1
    try:
        filename = insn[position].sal.symtab.fullname ()
    except:
        filename = None

    for i in reversed (insn[:position]):
	try:
            current = i.sal.symtab.fullname ()
	except:
            current = None

        if filename == current:
            continue

        rec.goto (i)
        return
</pre></div>

<p>Another possible application is to write a function that counts the
number of code executions in a given line range.  This line range can
contain parts of functions or span across several functions and is not
limited to be contiguous.
</p>
<div class="example smallexample">
<pre class="example-preformatted">def countrange (filename, linerange):
    count = 0

    def filter_only (file_name):
        for call in gdb.current_recording ().function_call_history:
            try:
                if file_name in call.symbol.symtab.fullname ():
                    yield call
            except:
                pass

    for c in filter_only (filename):
        for i in c.instructions:
            try:
                if i.sal.line in linerange:
                    count += 1
                    break;
            except:
                    pass

    return count
</pre></div>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="CLI-Commands-In-Python.html">CLI Commands In Python</a>, Previous: <a href="Threads-In-Python.html">Threads In Python</a>, Up: <a href="Python-API.html">Python API</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
