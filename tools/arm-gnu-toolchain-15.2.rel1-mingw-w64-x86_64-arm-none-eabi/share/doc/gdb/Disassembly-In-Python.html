<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- Copyright Â© 1988-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Free Software" and "Free Software Needs
Free Documentation", with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.

(a) The FSF's Back-Cover Text is: "You are free to copy and modify
this GNU Manual.  Buying copies from GNU Press supports the FSF in
developing GNU and promoting software freedom." -->
<title>Disassembly In Python (Debugging with GDB)</title>

<meta name="description" content="Disassembly In Python (Debugging with GDB)">
<meta name="keywords" content="Disassembly In Python (Debugging with GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Concept-Index.html" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Python-API.html" rel="up" title="Python API">
<link href="Missing-Debug-Info-In-Python.html" rel="next" title="Missing Debug Info In Python">
<link href="TUI-Windows-In-Python.html" rel="prev" title="TUI Windows In Python">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>


</head>

<body lang="en">
<div class="subsubsection-level-extent" id="Disassembly-In-Python">
<div class="nav-panel">
<p>
Next: <a href="Missing-Debug-Info-In-Python.html" accesskey="n" rel="next">Missing Debug Info In Python</a>, Previous: <a href="TUI-Windows-In-Python.html" accesskey="p" rel="prev">Implementing new TUI windows</a>, Up: <a href="Python-API.html" accesskey="u" rel="up">Python API</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsubsection" id="Instruction-Disassembly-In-Python"><span>23.3.2.40 Instruction Disassembly In Python<a class="copiable-link" href="#Instruction-Disassembly-In-Python"> &para;</a></span></h4>
<a class="index-entry-id" id="index-python-instruction-disassembly"></a>

<p><small class="sc">GDB</small>&rsquo;s builtin disassembler can be extended, or even replaced,
using the Python API.  The disassembler related features are contained
within the <code class="code">gdb.disassembler</code> module:
</p>
<a class="anchor" id="DisassembleInfo-Class"></a><dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassembleInfo"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.DisassembleInfo</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassembleInfo"> &para;</a></span></dt>
<dd><p>Disassembly is driven by instances of this class.  Each time
<small class="sc">GDB</small> needs to disassemble an instruction, an instance of this
class is created and passed to a registered disassembler.  The
disassembler is then responsible for disassembling an instruction and
returning a result.
</p>
<p>Instances of this type are usually created within <small class="sc">GDB</small>,
however, it is possible to create a copy of an instance of this type,
see the description of <code class="code">__init__</code> for more details.
</p>
<p>This class has the following properties and methods:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassembleInfo_002eaddress"><span class="category-def">Variable: </span><span><strong class="def-name">DisassembleInfo.address</strong><a class="copiable-link" href="#index-DisassembleInfo_002eaddress"> &para;</a></span></dt>
<dd><p>A read-only integer containing the address at which <small class="sc">GDB</small>
wishes to disassemble a single instruction.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassembleInfo_002earchitecture"><span class="category-def">Variable: </span><span><strong class="def-name">DisassembleInfo.architecture</strong><a class="copiable-link" href="#index-DisassembleInfo_002earchitecture"> &para;</a></span></dt>
<dd><p>The <code class="code">gdb.Architecture</code> (see <a class="pxref" href="Architectures-In-Python.html">Python representation of architectures</a>) for
which <small class="sc">GDB</small> is currently disassembling, this property is
read-only.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassembleInfo_002eprogspace"><span class="category-def">Variable: </span><span><strong class="def-name">DisassembleInfo.progspace</strong><a class="copiable-link" href="#index-DisassembleInfo_002eprogspace"> &para;</a></span></dt>
<dd><p>The <code class="code">gdb.Progspace</code> (see <a class="pxref" href="Progspaces-In-Python.html">Program Spaces
In Python</a>) for which <small class="sc">GDB</small> is currently disassembling, this
property is read-only.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassembleInfo_002eis_005fvalid"><span class="category-def">Function: </span><span><strong class="def-name">DisassembleInfo.is_valid</strong> <var class="def-var-arguments">()</var><a class="copiable-link" href="#index-DisassembleInfo_002eis_005fvalid"> &para;</a></span></dt>
<dd><p>Returns <code class="code">True</code> if the <code class="code">DisassembleInfo</code> object is valid,
<code class="code">False</code> if not.  A <code class="code">DisassembleInfo</code> object will become
invalid once the disassembly call for which the <code class="code">DisassembleInfo</code>
was created, has returned.  Calling other <code class="code">DisassembleInfo</code>
methods, or accessing <code class="code">DisassembleInfo</code> properties, will raise a
<code class="code">RuntimeError</code> exception if it is invalid.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassembleInfo_002e_005f_005finit_005f_005f"><span class="category-def">Function: </span><span><strong class="def-name">DisassembleInfo.__init__</strong> <var class="def-var-arguments">(info)</var><a class="copiable-link" href="#index-DisassembleInfo_002e_005f_005finit_005f_005f"> &para;</a></span></dt>
<dd><p>This can be used to create a new <code class="code">DisassembleInfo</code> object that is
a copy of <var class="var">info</var>.  The copy will have the same <code class="code">address</code>,
<code class="code">architecture</code>, and <code class="code">progspace</code> values as <var class="var">info</var>, and
will become invalid at the same time as <var class="var">info</var>.
</p>
<p>This method exists so that sub-classes of <code class="code">DisassembleInfo</code> can
be created, these sub-classes must be initialized as copies of an
existing <code class="code">DisassembleInfo</code> object, but sub-classes might choose
to override the <code class="code">read_memory</code> method, and so control what
<small class="sc">GDB</small> sees when reading from memory
(see <a class="pxref" href="#builtin_005fdisassemble">builtin_disassemble</a>).
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassembleInfo_002eread_005fmemory"><span class="category-def">Function: </span><span><strong class="def-name">DisassembleInfo.read_memory</strong> <var class="def-var-arguments">(length, offset)</var><a class="copiable-link" href="#index-DisassembleInfo_002eread_005fmemory"> &para;</a></span></dt>
<dd><p>This method allows the disassembler to read the bytes of the
instruction to be disassembled.  The method reads <var class="var">length</var> bytes,
starting at <var class="var">offset</var> from
<code class="code">DisassembleInfo.address</code>.
</p>
<p>It is important that the disassembler read the instruction bytes using
this method, rather than reading inferior memory directly, as in some
cases <small class="sc">GDB</small> disassembles from an internal buffer rather than
directly from inferior memory, calling this method handles this
detail.
</p>
<p>Returns a buffer object, which behaves much like an array or a string,
just as <code class="code">Inferior.read_memory</code> does
(see <a class="pxref" href="Inferiors-In-Python.html#gdbpy_005finferior_005fread_005fmemory">Inferior.read_memory</a>).  The
length of the returned buffer will always be exactly <var class="var">length</var>.
</p>
<p>If <small class="sc">GDB</small> is unable to read the required memory then a
<code class="code">gdb.MemoryError</code> exception is raised (see <a class="pxref" href="Exception-Handling.html">Exception Handling</a>).
</p>
<p>This method can be overridden by a sub-class in order to control what
<small class="sc">GDB</small> sees when reading from memory
(see <a class="pxref" href="#builtin_005fdisassemble">builtin_disassemble</a>).  When overriding this method it is
important to understand how <code class="code">builtin_disassemble</code> makes use of
this method.
</p>
<p>While disassembling a single instruction there could be multiple calls
to this method, and the same bytes might be read multiple times.  Any
single call might only read a subset of the total instruction bytes.
</p>
<p>If an implementation of <code class="code">read_memory</code> is unable to read the
requested memory contents, for example, if there&rsquo;s a request to read
from an invalid memory address, then a <code class="code">gdb.MemoryError</code> should
be raised.
</p>
<p>Raising a <code class="code">MemoryError</code> inside <code class="code">read_memory</code> does not
automatically mean a <code class="code">MemoryError</code> will be raised by
<code class="code">builtin_disassemble</code>.  It is possible the <small class="sc">GDB</small>&rsquo;s builtin
disassembler is probing to see how many bytes are available.  When
<code class="code">read_memory</code> raises the <code class="code">MemoryError</code> the builtin
disassembler might be able to perform a complete disassembly with the
bytes it has available, in this case <code class="code">builtin_disassemble</code> will
not itself raise a <code class="code">MemoryError</code>.
</p>
<p>Any other exception type raised in <code class="code">read_memory</code> will propagate
back and be re-raised by <code class="code">builtin_disassemble</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassembleInfo_002etext_005fpart"><span class="category-def">Function: </span><span><strong class="def-name">DisassembleInfo.text_part</strong> <var class="def-var-arguments">(style, string)</var><a class="copiable-link" href="#index-DisassembleInfo_002etext_005fpart"> &para;</a></span></dt>
<dd><p>Create a new <code class="code">DisassemblerTextPart</code> representing a piece of a
disassembled instruction.  <var class="var">string</var> should be a non-empty string,
and <var class="var">style</var> should be an appropriate style constant
(see <a class="pxref" href="#Disassembler-Style-Constants">Disassembler Style Constants</a>).
</p>
<p>Disassembler parts are used when creating a <code class="code">DisassemblerResult</code>
in order to represent the styling within an instruction
(see <a class="pxref" href="#DisassemblerResult-Class">DisassemblerResult Class</a>).
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassembleInfo_002eaddress_005fpart"><span class="category-def">Function: </span><span><strong class="def-name">DisassembleInfo.address_part</strong> <var class="def-var-arguments">(address)</var><a class="copiable-link" href="#index-DisassembleInfo_002eaddress_005fpart"> &para;</a></span></dt>
<dd><p>Create a new <code class="code">DisassemblerAddressPart</code>.  <var class="var">address</var> is the
value of the absolute address this part represents.  A
<code class="code">DisassemblerAddressPart</code> is displayed as an absolute address and
an associated symbol, the address and symbol are styled appropriately.
</p></dd></dl>

</dd></dl>

<a class="anchor" id="Disassembler-Class"></a><dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassembler"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.Disassembler</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassembler"> &para;</a></span></dt>
<dd><p>This is a base class from which all user implemented disassemblers
must inherit.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-Disassembler_002e_005f_005finit_005f_005f"><span class="category-def">Function: </span><span><strong class="def-name">Disassembler.__init__</strong> <var class="def-var-arguments">(name)</var><a class="copiable-link" href="#index-Disassembler_002e_005f_005finit_005f_005f"> &para;</a></span></dt>
<dd><p>The constructor takes <var class="var">name</var>, a string, which should be a short
name for this disassembler.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-Disassembler_002e_005f_005fcall_005f_005f"><span class="category-def">Function: </span><span><strong class="def-name">Disassembler.__call__</strong> <var class="def-var-arguments">(info)</var><a class="copiable-link" href="#index-Disassembler_002e_005f_005fcall_005f_005f"> &para;</a></span></dt>
<dd><p>The <code class="code">__call__</code> method must be overridden by sub-classes to
perform disassembly.  Calling <code class="code">__call__</code> on this base class will
raise a <code class="code">NotImplementedError</code> exception.
</p>
<p>The <var class="var">info</var> argument is an instance of <code class="code">DisassembleInfo</code>, and
describes the instruction that <small class="sc">GDB</small> wants disassembling.
</p>
<p>If this function returns <code class="code">None</code>, this indicates to <small class="sc">GDB</small>
that this sub-class doesn&rsquo;t wish to disassemble the requested
instruction.  <small class="sc">GDB</small> will then use its builtin disassembler to
perform the disassembly.
</p>
<p>Alternatively, this function can return a <code class="code">DisassemblerResult</code>
that represents the disassembled instruction, this type is described
in more detail below.
</p>
<p>The <code class="code">__call__</code> method can raise a <code class="code">gdb.MemoryError</code>
exception (see <a class="pxref" href="Exception-Handling.html">Exception Handling</a>) to indicate to <small class="sc">GDB</small>
that there was a problem accessing the required memory, this will then
be displayed by <small class="sc">GDB</small> within the disassembler output.
</p>
<p>Ideally, the only three outcomes from invoking <code class="code">__call__</code> would
be a return of <code class="code">None</code>, a successful disassembly returned in a
<code class="code">DisassemblerResult</code>, or a <code class="code">MemoryError</code> indicating that
there was a problem reading memory.
</p>
<p>However, as an implementation of <code class="code">__call__</code> could fail due to
other reasons, e.g. some external resource required to perform
disassembly is temporarily unavailable, then, if <code class="code">__call__</code>
raises a <code class="code">GdbError</code>, the exception will be converted to a string
and printed at the end of the disassembly output, the disassembly
request will then stop.
</p>
<p>Any other exception type raised by the <code class="code">__call__</code> method is
considered an error in the user code, the exception will be printed to
the error stream according to the <kbd class="kbd">set python print-stack</kbd> setting
(see <a class="pxref" href="Python-Commands.html#set_005fpython_005fprint_005fstack"><kbd class="kbd">set python print-stack</kbd></a>).
</p></dd></dl>
</dd></dl>

<a class="anchor" id="DisassemblerResult-Class"></a><dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassemblerResult"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.DisassemblerResult</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassemblerResult"> &para;</a></span></dt>
<dd><p>This class represents the result of disassembling a single
instruction.  An instance of this class will be returned from
<code class="code">builtin_disassemble</code> (see <a class="pxref" href="#builtin_005fdisassemble">builtin_disassemble</a>), and an
instance of this class should be returned from
<code class="code">Disassembler.__call__</code><!-- /@w --> (see <a class="pxref" href="#Disassembler-Class">Disassembler Class</a>) if an
instruction was successfully disassembled.
</p>
<p>It is not possible to sub-class the <code class="code">DisassemblerResult</code> class.
</p>
<p>The <code class="code">DisassemblerResult</code> class has the following properties and
methods:
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-DisassemblerResult_002e_005f_005finit_005f_005f"><span class="category-def">Function: </span><span><strong class="def-name">DisassemblerResult.__init__</strong> <var class="def-var-arguments">(length, string, parts)</var><a class="copiable-link" href="#index-DisassemblerResult_002e_005f_005finit_005f_005f"> &para;</a></span></dt>
<dd><p>Initialize an instance of this class, <var class="var">length</var> is the length of
the disassembled instruction in bytes, which must be greater than
zero.
</p>
<p>Only one of <var class="var">string</var> or <var class="var">parts</var> should be used to initialize a
new <code class="code">DisassemblerResult</code>; the other one should be passed the
value <code class="code">None</code>.  Alternatively, the arguments can be passed by
name, and the unused argument can be ignored.
</p>
<p>The <var class="var">string</var> argument, if not <code class="code">None</code>, is a non-empty string
that represents the entire disassembled instruction.  Building a result
object using the <var class="var">string</var> argument does not allow for any styling
information to be included in the result.  <small class="sc">GDB</small> will style the
result as a single <code class="code">DisassemblerTextPart</code> with <code class="code">STYLE_TEXT</code>
style (see <a class="pxref" href="#Disassembler-Styling-Parts">Disassembler Styling Parts</a>).
</p>
<p>The <var class="var">parts</var> argument, if not <code class="code">None</code>, is a non-empty sequence
of <code class="code">DisassemblerPart</code> objects.  Each part represents a small part
of the disassembled instruction along with associated styling
information.  A result object built using <var class="var">parts</var> can be displayed
by <small class="sc">GDB</small> with full styling information
(see <a class="pxref" href="Output-Styling.html#style_005fdisassembler_005fenabled"><kbd class="kbd">set style disassembler
enabled</kbd></a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerResult_002elength"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerResult.length</strong><a class="copiable-link" href="#index-DisassemblerResult_002elength"> &para;</a></span></dt>
<dd><p>A read-only property containing the length of the disassembled
instruction in bytes, this will always be greater than zero.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerResult_002estring"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerResult.string</strong><a class="copiable-link" href="#index-DisassemblerResult_002estring"> &para;</a></span></dt>
<dd><p>A read-only property containing a non-empty string representing the
disassembled instruction.  The <var class="var">string</var> is a representation of the
disassembled instruction without any styling information.  To see how
the instruction will be styled use the <var class="var">parts</var> property.
</p>
<p>If this instance was initialized using separate
<code class="code">DisassemblerPart</code> objects, the <var class="var">string</var> property will still
be valid.  The <var class="var">string</var> value is created by concatenating the
<code class="code">DisassemblerPart.string</code> values of each component part
(see <a class="pxref" href="#Disassembler-Styling-Parts">Disassembler Styling Parts</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerResult_002eparts"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerResult.parts</strong><a class="copiable-link" href="#index-DisassemblerResult_002eparts"> &para;</a></span></dt>
<dd><p>A read-only property containing a non-empty sequence of
<code class="code">DisassemblerPart</code> objects.  Each <code class="code">DisassemblerPart</code> object
contains a small part of the instruction along with information about
how that part should be styled.  <small class="sc">GDB</small> uses this information to
create styled disassembler output
(see <a class="pxref" href="Output-Styling.html#style_005fdisassembler_005fenabled"><kbd class="kbd">set style disassembler
enabled</kbd></a>).
</p>
<p>If this instance was initialized using a single string rather than
with a sequence of <code class="code">DisassemblerPart</code> objects, the <var class="var">parts</var>
property will still be valid.  In this case the <var class="var">parts</var> property
will hold a sequence containing a single <code class="code">DisassemblerTextPart</code>
object, the string of which will represent the entire instruction, and
the style of which will be <code class="code">STYLE_TEXT</code>.
</p></dd></dl>
</dd></dl>

<a class="anchor" id="Disassembler-Styling-Parts"></a><dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassemblerPart"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.DisassemblerPart</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassemblerPart"> &para;</a></span></dt>
<dd><p>This is a parent class from which the different part sub-classes
inherit.  Only instances of the sub-classes detailed below will be
returned by the Python API.
</p>
<p>It is not possible to directly create instances of either this parent
class, or any of the sub-classes listed below.  Instances of the
sub-classes listed below are created by calling
<code class="code">builtin_disassemble</code> (see <a class="pxref" href="#builtin_005fdisassemble">builtin_disassemble</a>) and are
returned within the <code class="code">DisassemblerResult</code> object, or can be
created by calling the <code class="code">text_part</code> and <code class="code">address_part</code>
methods on the <code class="code">DisassembleInfo</code> class (see <a class="pxref" href="#DisassembleInfo-Class">DisassembleInfo Class</a>).
</p>
<p>The <code class="code">DisassemblerPart</code> class has a single property:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerPart_002estring"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerPart.string</strong><a class="copiable-link" href="#index-DisassemblerPart_002estring"> &para;</a></span></dt>
<dd><p>A read-only property that contains a non-empty string representing
this part of the disassembled instruction.  The string within this
property doesn&rsquo;t include any styling information.
</p></dd></dl>
</dd></dl>

<dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassemblerTextPart"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.DisassemblerTextPart</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassemblerTextPart"> &para;</a></span></dt>
<dd><p>The <code class="code">DisassemblerTextPart</code> class represents a piece of the
disassembled instruction and the associated style for that piece.
Instances of this class can&rsquo;t be created directly, instead call
<code class="code">DisassembleInfo.text_part</code> to create a new instance of this
class (see <a class="pxref" href="#DisassembleInfo-Class">DisassembleInfo Class</a>).
</p>
<p>As well as the properties of its parent class, the
<code class="code">DisassemblerTextPart</code> has the following additional property:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerTextPart_002estyle"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerTextPart.style</strong><a class="copiable-link" href="#index-DisassemblerTextPart_002estyle"> &para;</a></span></dt>
<dd><p>A read-only property that contains one of the defined style constants.
<small class="sc">GDB</small> will use this style when styling this part of the
disassembled instruction (see <a class="pxref" href="#Disassembler-Style-Constants">Disassembler Style Constants</a>).
</p></dd></dl>
</dd></dl>

<dl class="first-deftp">
<dt class="deftp" id="index-gdb_002edisassembler_002eDisassemblerAddressPart"><span class="category-def">class: </span><span><strong class="def-name">gdb.disassembler.DisassemblerAddressPart</strong><a class="copiable-link" href="#index-gdb_002edisassembler_002eDisassemblerAddressPart"> &para;</a></span></dt>
<dd><p>The <code class="code">DisassemblerAddressPart</code> class represents an absolute
address within a disassembled instruction.  Using a
<code class="code">DisassemblerAddressPart</code> instead of a
<code class="code">DisassemblerTextPart</code> with <code class="code">STYLE_ADDRESS</code> is preferred,
<small class="sc">GDB</small> will display the address as both an absolute address, and
will look up a suitable symbol to display next to the address.  Using
<code class="code">DisassemblerAddressPart</code> also ensures that user settings such as
<code class="code">set print max-symbolic-offset</code> are respected.
</p>
<p>Here is an example of an x86-64 instruction:
</p>
<div class="example smallexample">
<pre class="example-preformatted">call   0x401136 &lt;foo&gt;
</pre></div>

<p>In this instruction the <code class="code">0x401136 &lt;foo&gt;</code> was generated from a
single <code class="code">DisassemblerAddressPart</code>.  The <code class="code">0x401136</code> will be
styled with <code class="code">STYLE_ADDRESS</code>, and <code class="code">foo</code> will be styled with
<code class="code">STYLE_SYMBOL</code>.  The <code class="code">&lt;</code> and <code class="code">&gt;</code> will be styled as
<code class="code">STYLE_TEXT</code>.
</p>
<p>If the inclusion of the symbol name is not required then a
<code class="code">DisassemblerTextPart</code> with style <code class="code">STYLE_ADDRESS</code> can be
used instead.
</p>
<p>Instances of this class can&rsquo;t be created directly, instead call
<code class="code">DisassembleInfo.address_part</code> to create a new instance of this
class (see <a class="pxref" href="#DisassembleInfo-Class">DisassembleInfo Class</a>).
</p>
<p>As well as the properties of its parent class, the
<code class="code">DisassemblerAddressPart</code> has the following additional property:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-DisassemblerAddressPart_002eaddress"><span class="category-def">Variable: </span><span><strong class="def-name">DisassemblerAddressPart.address</strong><a class="copiable-link" href="#index-DisassemblerAddressPart_002eaddress"> &para;</a></span></dt>
<dd><p>A read-only property that contains the <var class="var">address</var> passed to this
object&rsquo;s <code class="code">__init__</code> method.
</p></dd></dl>
</dd></dl>

<a class="anchor" id="Disassembler-Style-Constants"></a>
<p>The following table lists all of the disassembler styles that are
available.  <small class="sc">GDB</small> maps these style constants onto its style
settings (see <a class="pxref" href="Output-Styling.html">Output Styling</a>).  In some cases, several style
constants produce the same style settings, and thus will produce the
same visual effect on the screen.  This could change in future
releases of <small class="sc">GDB</small>, so care should be taken to select the
correct style constant to ensure correct output styling in future
releases of <small class="sc">GDB</small>.
</p>
<dl class="vtable">
<dt><a class="index-entry-id" id="index-STYLE_005fTEXT"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fTEXT"></a><span><code class="code">gdb.disassembler.STYLE_TEXT</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fTEXT"> &para;</a></span></dt>
<dd><p>This is the default style used by <small class="sc">GDB</small> when styling
disassembler output.  This style should be used for any parts of the
instruction that don&rsquo;t fit any of the other styles listed below.
<small class="sc">GDB</small> styles text with this style using its default style.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fMNEMONIC"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fMNEMONIC"></a><span><code class="code">gdb.disassembler.STYLE_MNEMONIC</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fMNEMONIC"> &para;</a></span></dt>
<dd><p>This style is used for styling the primary instruction mnemonic, which
usually appears at, or near, the start of the disassembled instruction
string.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
mnemonic</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fSUB_005fMNEMONIC"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fSUB_005fMNEMONIC"></a><span><code class="code">gdb.disassembler.STYLE_SUB_MNEMONIC</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fSUB_005fMNEMONIC"> &para;</a></span></dt>
<dd><p>This style is used for styling any sub-mnemonics within a disassembled
instruction.  A sub-mnemonic is any text within the instruction that
controls the function of the instruction, but which is disjoint from
the primary mnemonic (which will have styled <code class="code">STYLE_MNEMONIC</code>).
</p>
<p>As an example, consider this AArch64 instruction:
</p>
<div class="example smallexample">
<pre class="example-preformatted">add	w16, w7, w1, lsl #1
</pre></div>

<p>The <code class="code">add</code> is the primary instruction mnemonic, and would be given
style <code class="code">STYLE_MNEMONIC</code>, while <code class="code">lsl</code> is the sub-mnemonic, and
would be given the style <code class="code">STYLE_SUB_MNEMONIC</code>.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
mnemonic</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fASSEMBLER_005fDIRECTIVE"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fASSEMBLER_005fDIRECTIVE"></a><span><code class="code">gdb.disassembler.STYLE_ASSEMBLER_DIRECTIVE</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fASSEMBLER_005fDIRECTIVE"> &para;</a></span></dt>
<dd><p>Sometimes a series of bytes doesn&rsquo;t decode to a valid instruction.  In
this case the disassembler may choose to represent the result of
disassembling using an assembler directive, for example:
</p>
<div class="example smallexample">
<pre class="example-preformatted">.word	0x1234
</pre></div>

<p>In this case, the <code class="code">.word</code> would be give the
<code class="code">STYLE_ASSEMBLER_DIRECTIVE</code> style.  An assembler directive is
similar to a mnemonic in many ways but is something that is not part
of the architecture&rsquo;s instruction set.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
mnemonic</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fREGISTER"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fREGISTER"></a><span><code class="code">gdb.disassembler.STYLE_REGISTER</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fREGISTER"> &para;</a></span></dt>
<dd><p>This style is used for styling any text that represents a register
name, or register number, within a disassembled instruction.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
register</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fADDRESS"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fADDRESS"></a><span><code class="code">gdb.disassembler.STYLE_ADDRESS</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fADDRESS"> &para;</a></span></dt>
<dd><p>This style is used for styling numerical values that represent
absolute addresses within the disassembled instruction.
</p>
<p>When creating a <code class="code">DisassemblerTextPart</code> with this style, you
should consider if a <code class="code">DisassemblerAddressPart</code> would be more
appropriate.  See <a class="ref" href="#Disassembler-Styling-Parts">Disassembler Styling Parts</a> for a description
of what each part offers.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
address</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fADDRESS_005fOFFSET"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fADDRESS_005fOFFSET"></a><span><code class="code">gdb.disassembler.STYLE_ADDRESS_OFFSET</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fADDRESS_005fOFFSET"> &para;</a></span></dt>
<dd><p>This style is used for styling numerical values that represent offsets
to addresses within the disassembled instruction.  A value is
considered an address offset when the instruction itself is going to
access memory, and the value is being used to offset which address is
accessed.
</p>
<p>For example, an architecture might have an instruction that loads from
memory using an address within a register.  If that instruction also
allowed for an immediate offset to be encoded into the instruction,
this would be an address offset.  Similarly, a branch instruction
might jump to an address in a register plus an address offset that is
encoded into the instruction.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
immediate</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fIMMEDIATE"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fIMMEDIATE"></a><span><code class="code">gdb.disassembler.STYLE_IMMEDIATE</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fIMMEDIATE"> &para;</a></span></dt>
<dd><p>Use <code class="code">STYLE_IMMEDIATE</code> for any numerical values within a
disassembled instruction when those values are not addresses, address
offsets, or register numbers (The styles <code class="code">STYLE_ADDRESS</code>,
<code class="code">STYLE_ADDRESS_OFFSET</code>, or <code class="code">STYLE_REGISTER</code> can be used in
those cases).
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
immediate</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fSYMBOL"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fSYMBOL"></a><span><code class="code">gdb.disassembler.STYLE_SYMBOL</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fSYMBOL"> &para;</a></span></dt>
<dd><p>This style is used for styling the textual name of a symbol that is
included within a disassembled instruction.  A symbol name is often
included next to an absolute address within a disassembled instruction
to make it easier for the user to understand what the address is
referring too.  For example:
</p>
<div class="example smallexample">
<pre class="example-preformatted">call   0x401136 &lt;foo&gt;
</pre></div>

<p>Here <code class="code">foo</code> is the name of a symbol, and should be given the
<code class="code">STYLE_SYMBOL</code> style.
</p>
<p>Adding symbols next to absolute addresses like this is handled
automatically by the <code class="code">DisassemblerAddressPart</code> class
(see <a class="pxref" href="#Disassembler-Styling-Parts">Disassembler Styling Parts</a>).
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
symbol</code> style setting.
</p>
</dd>
<dt><a class="index-entry-id" id="index-STYLE_005fCOMMENT_005fSTART"></a>
<a id="index-gdb_002edisassembler_002eSTYLE_005fCOMMENT_005fSTART"></a><span><code class="code">gdb.disassembler.STYLE_COMMENT_START</code><a class="copiable-link" href="#index-gdb_002edisassembler_002eSTYLE_005fCOMMENT_005fSTART"> &para;</a></span></dt>
<dd><p>This style is used to start a line comment in the disassembly output.
Unlike other styles, which only apply to the single
<code class="code">DisassemblerTextPiece</code> to which they are applied, the comment
style is sticky, and overrides the style of any further pieces within
this instruction.
</p>
<p>This means that, after a <code class="code">STYLE_COMMENT_START</code> piece has been
seen, <small class="sc">GDB</small> will apply the comment style until the end of the
line, ignoring the specific style within a piece.
</p>
<p><small class="sc">GDB</small> styles text with this style using the <code class="code">disassembler
comment</code> style setting.
</p></dd>
</dl>

<p>The following functions are also contained in the
<code class="code">gdb.disassembler</code> module:
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-register_005fdisassembler"><span class="category-def">Function: </span><span><strong class="def-name">register_disassembler</strong> <var class="def-var-arguments">(disassembler, architecture)</var><a class="copiable-link" href="#index-register_005fdisassembler"> &para;</a></span></dt>
<dd><p>The <var class="var">disassembler</var> must be a sub-class of
<code class="code">gdb.disassembler.Disassembler</code> or <code class="code">None</code>.
</p>
<p>The optional <var class="var">architecture</var> is either a string, or the value
<code class="code">None</code>.  If it is a string, then it should be the name of an
architecture known to <small class="sc">GDB</small>, as returned either from
<code class="code">gdb.Architecture.name</code>
(see <a class="pxref" href="Architectures-In-Python.html#gdbpy_005farchitecture_005fname">gdb.Architecture.name</a>), or from
<code class="code">gdb.architecture_names</code>
(see <a class="pxref" href="Basic-Python.html#gdb_005farchitecture_005fnames">gdb.architecture_names</a>).
</p>
<p>The <var class="var">disassembler</var> will be installed for the architecture named by
<var class="var">architecture</var>, or if <var class="var">architecture</var> is <code class="code">None</code>, then
<var class="var">disassembler</var> will be installed as a global disassembler for use
by all architectures.
</p>
<a class="index-entry-id" id="index-disassembler-in-Python_002c-global-vs_002e-specific"></a>
<a class="index-entry-id" id="index-search-order-for-disassembler-in-Python"></a>
<a class="index-entry-id" id="index-look-up-of-disassembler-in-Python"></a>
<p><small class="sc">GDB</small> only records a single disassembler for each architecture,
and a single global disassembler.  Calling
<code class="code">register_disassembler</code> for an architecture, or for the global
disassembler, will replace any existing disassembler registered for
that <var class="var">architecture</var> value.  The previous disassembler is returned.
</p>
<p>If <var class="var">disassembler</var> is <code class="code">None</code> then any disassembler currently
registered for <var class="var">architecture</var> is deregistered and returned.
</p>
<p>When <small class="sc">GDB</small> is looking for a disassembler to use, <small class="sc">GDB</small>
first looks for an architecture specific disassembler.  If none has
been registered then <small class="sc">GDB</small> looks for a global disassembler (one
registered with <var class="var">architecture</var> set to <code class="code">None</code>).  Only one
disassembler is called to perform disassembly, so, if there is both an
architecture specific disassembler, and a global disassembler
registered, it is the architecture specific disassembler that will be
used.
</p>
<p><small class="sc">GDB</small> tracks the architecture specific, and global
disassemblers separately, so it doesn&rsquo;t matter in which order
disassemblers are created or registered; an architecture specific
disassembler, if present, will always be used in preference to a
global disassembler.
</p>
<p>You can use the <kbd class="kbd">maint info python-disassemblers</kbd> command
(see <a class="pxref" href="Maintenance-Commands.html#maint-info-python_002ddisassemblers">maint info python-disassemblers</a>) to see which disassemblers
have been registered.
</p></dd></dl>

<a class="anchor" id="builtin_005fdisassemble"></a><dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-builtin_005fdisassemble"><span class="category-def">Function: </span><span><strong class="def-name">builtin_disassemble</strong> <var class="def-var-arguments">(info)</var><a class="copiable-link" href="#index-builtin_005fdisassemble"> &para;</a></span></dt>
<dd><p>This function calls back into <small class="sc">GDB</small>&rsquo;s builtin disassembler to
disassemble the instruction identified by <var class="var">info</var>, an instance, or
sub-class, of <code class="code">DisassembleInfo</code>.
</p>
<p>When the builtin disassembler needs to read memory the
<code class="code">read_memory</code> method on <var class="var">info</var> will be called.  By
sub-classing <code class="code">DisassembleInfo</code> and overriding the
<code class="code">read_memory</code> method, it is possible to intercept calls to
<code class="code">read_memory</code> from the builtin disassembler, and to modify the
values returned.
</p>
<p>It is important to understand that, even when
<code class="code">DisassembleInfo.read_memory</code> raises a <code class="code">gdb.MemoryError</code>, it
is the internal disassembler itself that reports the memory error to
<small class="sc">GDB</small>.  The reason for this is that the disassembler might
probe memory to see if a byte is readable or not; if the byte can&rsquo;t be
read then the disassembler may choose not to report an error, but
instead to disassemble the bytes that it does have available.
</p>
<p>If the builtin disassembler is successful then an instance of
<code class="code">DisassemblerResult</code> is returned from <code class="code">builtin_disassemble</code>,
alternatively, if something goes wrong, an exception will be raised.
</p>
<p>A <code class="code">MemoryError</code> will be raised if <code class="code">builtin_disassemble</code> is
unable to read some memory that is required in order to perform
disassembly correctly.
</p>
<p>Any exception that is not a <code class="code">MemoryError</code>, that is raised in a
call to <code class="code">read_memory</code>, will pass through
<code class="code">builtin_disassemble</code>, and be visible to the caller.
</p>
<p>Finally, there are a few cases where <small class="sc">GDB</small>&rsquo;s builtin
disassembler can fail for reasons that are not covered by
<code class="code">MemoryError</code>.  In these cases, a <code class="code">GdbError</code> will be raised.
The contents of the exception will be a string describing the problem
the disassembler encountered.
</p></dd></dl>

<p>Here is an example that registers a global disassembler.  The new
disassembler invokes the builtin disassembler, and then adds a
comment, <code class="code">## Comment</code>, to each line of disassembly output:
</p>
<div class="example smallexample">
<pre class="example-preformatted">class ExampleDisassembler(gdb.disassembler.Disassembler):
    def __init__(self):
        super().__init__(&quot;ExampleDisassembler&quot;)

    def __call__(self, info):
        result = gdb.disassembler.builtin_disassemble(info)
        length = result.length
        text = result.string + &quot;\t## Comment&quot;
        return gdb.disassembler.DisassemblerResult(length, text)

gdb.disassembler.register_disassembler(ExampleDisassembler())
</pre></div>

<p>The following example creates a sub-class of <code class="code">DisassembleInfo</code> in
order to intercept the <code class="code">read_memory</code> calls, within
<code class="code">read_memory</code> any bytes read from memory have the two 4-bit
nibbles swapped around.  This isn&rsquo;t a very useful adjustment, but
serves as an example.
</p>
<div class="example smallexample">
<pre class="example-preformatted">class MyInfo(gdb.disassembler.DisassembleInfo):
    def __init__(self, info):
        super().__init__(info)

    def read_memory(self, length, offset):
        buffer = super().read_memory(length, offset)
        result = bytearray()
        for b in buffer:
            v = int.from_bytes(b, 'little')
            v = (v &lt;&lt; 4) &amp; 0xf0 | (v &gt;&gt; 4)
            result.append(v)
        return memoryview(result)

class NibbleSwapDisassembler(gdb.disassembler.Disassembler):
    def __init__(self):
        super().__init__(&quot;NibbleSwapDisassembler&quot;)

    def __call__(self, info):
        info = MyInfo(info)
        return gdb.disassembler.builtin_disassemble(info)

gdb.disassembler.register_disassembler(NibbleSwapDisassembler())
</pre></div>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Missing-Debug-Info-In-Python.html">Missing Debug Info In Python</a>, Previous: <a href="TUI-Windows-In-Python.html">Implementing new TUI windows</a>, Up: <a href="Python-API.html">Python API</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
