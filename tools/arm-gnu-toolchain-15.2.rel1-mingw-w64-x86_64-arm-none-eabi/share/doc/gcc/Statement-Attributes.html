<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This file documents the use of the GNU compilers.

Copyright Â© 1988-2025 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Funding Free Software", the Front-Cover
Texts being (a) (see below), and with the Back-Cover Texts being (b)
(see below).  A copy of the license is included in the section entitled
"GNU Free Documentation License".

(a) The FSF's Front-Cover Text is:

A GNU Manual

(b) The FSF's Back-Cover Text is:

You have freedom to copy and modify this GNU Manual, like GNU
     software.  Copies published by the Free Software Foundation raise
     funds for GNU development. -->
<title>Statement Attributes (Using the GNU Compiler Collection (GCC))</title>

<meta name="description" content="Statement Attributes (Using the GNU Compiler Collection (GCC))">
<meta name="keywords" content="Statement Attributes (Using the GNU Compiler Collection (GCC))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Indices.html" rel="index" title="Indices">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Attributes.html" rel="up" title="Attributes">
<link href="Attribute-Syntax.html" rel="next" title="Attribute Syntax">
<link href="Enumerator-Attributes.html" rel="prev" title="Enumerator Attributes">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="en_US">
<div class="subsection-level-extent" id="Statement-Attributes">
<div class="nav-panel">
<p>
Next: <a href="Attribute-Syntax.html" accesskey="n" rel="next">Attribute Syntax</a>, Previous: <a href="Enumerator-Attributes.html" accesskey="p" rel="prev">Enumerator Attributes</a>, Up: <a href="Attributes.html" accesskey="u" rel="up">Attributes Specific to GCC</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Indices.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Statement-Attributes-1"><span>6.4.6 Statement Attributes<a class="copiable-link" href="#Statement-Attributes-1"> &para;</a></span></h4>
<a class="index-entry-id" id="index-Statement-Attributes"></a>

<p>GCC allows attributes to be set on statements.  See <a class="xref" href="Attribute-Syntax.html">Attribute Syntax</a>,
for details of the exact syntax for using attributes.  Other attributes are
available for functions (see <a class="pxref" href="Function-Attributes.html">Declaring Attributes of Functions</a>), variables
(see <a class="pxref" href="Variable-Attributes.html">Specifying Attributes of Variables</a>), labels (see <a class="pxref" href="Label-Attributes.html">Label Attributes</a>), enumerators
(see <a class="pxref" href="Enumerator-Attributes.html">Enumerator Attributes</a>), and for types (see <a class="pxref" href="Type-Attributes.html">Specifying Attributes of Types</a>).
</p>
<dl class="table">
<dt><a id="index-fallthrough-statement-attribute"></a><span><code class="code">fallthrough</code><a class="copiable-link" href="#index-fallthrough-statement-attribute"> &para;</a></span></dt>
<dd><p>The <code class="code">fallthrough</code> attribute with a null statement serves as a
fallthrough statement.  It hints to the compiler that a statement
that falls through to another case label, or user-defined label
in a switch statement is intentional and thus the
<samp class="option">-Wimplicit-fallthrough</samp> warning must not trigger.  The
fallthrough attribute may appear at most once in each attribute
list, and may not be mixed with other attributes.  It can only
be used in a switch statement (the compiler will issue an error
otherwise), after a preceding statement and before a logically
succeeding case label, or user-defined label.
</p>
<p>This example uses the <code class="code">fallthrough</code> statement attribute to indicate that
the <samp class="option">-Wimplicit-fallthrough</samp> warning should not be emitted:
</p>
<div class="example smallexample">
<pre class="example-preformatted">switch (cond)
  {
  case 1:
    bar (1);
    __attribute__((fallthrough));
  case 2:
    ...
  }
</pre></div>

</dd>
<dt><a id="index-assume-statement-attribute"></a><span><code class="code">assume</code><a class="copiable-link" href="#index-assume-statement-attribute"> &para;</a></span></dt>
<dd><p>The <code class="code">assume</code> attribute with a null statement serves as portable
assumption.  It should have a single argument, a conditional expression,
which is not evaluated.  If the argument would evaluate to true
at the point where it appears, it has no effect, otherwise there
is undefined behavior.  This is a GNU variant of the ISO C++23
standard <code class="code">assume</code> attribute, but it can be used in any version of
both C and C++.
</p>
<div class="example smallexample">
<pre class="example-preformatted">int
foo (int x, int y)
{
  __attribute__((assume(x == 42)));
  __attribute__((assume(++y == 43)));
  return x + y;
}
</pre></div>

<p><code class="code">y</code> is not actually incremented and the compiler can but does not
have to optimize it to just <code class="code">return 42 + 42;</code>.
</p>
</dd>
<dt><a id="index-musttail-statement-attribute"></a><span><code class="code">musttail</code><a class="copiable-link" href="#index-musttail-statement-attribute"> &para;</a></span></dt>
<dd>
<p>The <code class="code">gnu::musttail</code> or <code class="code">clang::musttail</code> standard attribute
or <code class="code">musttail</code> GNU attribute can be applied to a <code class="code">return</code> statement
with a return-value expression that is a function call.  It asserts that the
call must be a tail call that does not allocate extra stack space, so it is
safe to use tail recursion to implement long-running loops.
</p>
<div class="example smallexample">
<pre class="example-preformatted">[[gnu::musttail]] return foo();
</pre></div>

<div class="example smallexample">
<pre class="example-preformatted">__attribute__((musttail)) return bar();
</pre></div>

<p>If the compiler cannot generate a <code class="code">musttail</code> tail call it reports
an error.  On some targets, tail calls may not be supported at all.
The <code class="code">musttail</code> attribute asserts that the lifetime of automatic
variables, function parameters and temporaries (unless they have non-trivial
destruction) can end before the actual call instruction, and that any access
to those from inside of the called function results is considered undefined
behavior.  Enabling <samp class="option">-O1</samp> or <samp class="option">-O2</samp> can improve the success of
tail calls.
</p>
<div class="example smallexample">
<pre class="example-preformatted">int foo (int *);
void bar (int *);
struct S { S (); ~S (); int s; };

int
baz (int *x)
{
  if (*x == 1)
    {
      int a = 42;
      /* The call is a tail call (would not be without the
         attribute).  Dereferencing the pointer in the callee is
         undefined behavior, and there is a warning emitted
         for this by default (<samp class="option">-Wmusttail-local-addr</samp>).  */
      [[gnu::musttail]] return foo (&amp;a);
    }
  else if (*x == 2)
    {
      int a = 42;
      bar (&amp;a);
      /* The call is a tail call (would not be without the
         attribute).  If bar stores the pointer anywhere, dereferencing
         it in foo is undefined behavior.  There is a warning
         emitted for this with <samp class="option">-Wextra</samp>, which implies
         <samp class="option">-Wmaybe-musttail-local-addr</samp>.  */
      [[gnu::musttail]] return foo (nullptr);
    }
  else
    {
      S s;
      /* The s variable requires non-trivial destruction which ought
         to be performed after the foo call returns, so this is
         rejected.  */
      [[gnu::musttail]] return foo (&amp;s.s);
    }
}
</pre></div>

<p>To avoid the <samp class="option">-Wmaybe-musttail-local-addr</samp> warning in the
above <code class="code">*x == 2</code> case and similar code, consider defining the
maybe-escaped variables in a separate scope that ends before the
return statement, if that is possible, to make it clear that the
variable is not live during the call.  So:
</p>
<div class="example smallexample">
<pre class="example-preformatted">  else if (*x == 2)
    {
      {
        int a = 42;
        bar (&amp;a);
      }
      /* The call is a tail call (would not be without the
         attribute).  If bar stores the pointer anywhere, dereferencing
         it in foo is undefined behavior even without tail call
         optimization, and there is no warning.  */
      [[gnu::musttail]] return foo (nullptr);
    }
</pre></div>

<p>It is not possible to avoid the warning in this way if the maybe-escaped
variable is a function argument, because those are in scope
for the whole function.
</p></dd>
</dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Attribute-Syntax.html">Attribute Syntax</a>, Previous: <a href="Enumerator-Attributes.html">Enumerator Attributes</a>, Up: <a href="Attributes.html">Attributes Specific to GCC</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Indices.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
